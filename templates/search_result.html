{% extends 'base.html' %}

{% block content %}
    <h2>Search</h2>

    <form method="get" action=".">
        <table>
            <!-- {{ form.as_table }} -->
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="text" placeholder="Search" name="q" id="q">
                </td>
            </tr>
        </table>

  
     </form>

    {% if query %}
      <h3> Communities </h3>
      <div class="container">

      {% for result in object_list|slice:":1" %}

                {% if result.object.name %}
                    <div class="mix-grid thumbnails">
                      {{myhtml|safe}}
                       <div class="col-md-3 col-sm-4 mix mix_all" style="display: block; opacity: 1; width: 280px;">
                        <div class="mix-inner">
                          {% if result.object.image %}
                          <img src="{{ MEDIA_URL }}{{ community.image}}" alt="image" class="img-responsive" style="height: 280px; width: 280px;">
                          {% else %}
                          <img src="{{ MEDIA_URL }}default/community_image_default.png" alt="default" class="img-responsive" style="height: 280px; width: 280px;">
                          {%endif%}

                          <div class="mix-details">
                            <h4>{{result.object.name}}</h4>
                            <h5>{{result.object.tag_line|truncatewords:5}}</h5>
                            <p>{{ result.object.desc |striptags|truncatewords:20}}</p>
                            <a class="mix-link" href="{% url 'community_view' result.object.pk %}">
                              <i class="fa fa-link"></i>View More
                            </a>

                            {% if result.object.image %}
                            <a data-rel="fancybox-button" title="{{result.object.name}}" href="{{ MEDIA_URL }}{{ result.object.image}}" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% else %}
                            <a data-rel="fancybox-button" title="{{result.object.name}}" href="{{ MEDIA_URL }}default/community_image_default.png" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% endif %}

                          </div>
                        <h3>{{result.object.name|truncatewords:2}}</h3>
                        {{result.object.category|truncatewords:2 }}
                      </div>
                    </div>
                      </div>
                      
                 {% else %}
                     <p>No results found.</p>
                 {% endif %}  <!-- result.object.name -->
      
                
            {% endfor %}

        </div>
       

            <br>
            <h3> Articles </h3>
            <div class="infinite-container">
            {% for result in object_list|slice:":1" %}
                {% if result.object.body %}
                
                {% if result.object.state.name == "publish" %}
                <!-- BEGIN CONTENT -->
                
                      {{myhtml|safe}}
                      <div class="infinite-item">
                       <div class="col-md-3 col-sm-4 mix mix_all" style="display: block; opacity: 1; width: 280px;">
                        <div class="mix-inner">
                          {% if result.object.image %}
                          <img src="{{ MEDIA_URL }}{{ article.image}}" alt="image" class="img-responsive" style="height: 280px; width: 280px;">
                          {% else %}
                          <img src="{{ MEDIA_URL }}default/article_image_default.png" alt="default" class="img-responsive" style="height: 280px; width: 280px;">
                          {%endif%}

                          <div class="mix-details">
                            <h4>{{result.object.title}}</h4>
                            <h5>{{result.object.tag_line|truncatewords:5}}</h5>
                            <p>{{ result.object.desc |striptags|truncatewords:20}}</p>
                            <a class="mix-link" href="{% url 'article_view' result.object.pk %}">
                              <i class="fa fa-link"></i>View More
                            </a>

                            {% if result.object.image %}
                            <a data-rel="fancybox-button" title="{{result.object.title}}" href="{{ MEDIA_URL }}{{ result.object.image}}" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% else %}
                            <a data-rel="fancybox-button" title="{{result.object.title}}" href="{{ MEDIA_URL }}default/article_image_default.png" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% endif %}

                          </div>
                        <h3>{{result.object.name|truncatewords:2}}</h3>
                        {{result.object.category|truncatewords:2 }}
                      </div>
                      </div>
                  </div>
                
                </div>

                {% endif %}
                {% else %}
                  No articles found.
                {% endif %}

            {% empty %}
                <p>No results found.</p>
            {% endfor %}

        </div>

        <br>
        <h3> Media </h3>
        <div class="infinite-container">
        {% for result in object_list %}
        <h5>{{ result.object.mediatype }}</h5>
        {% if result.object.mediafile %}

        <div class="col-md-3 col-sm-4 gallery-item">
          <a data-rel="fancybox-button"
            title=""
            href="{{ MEDIA_URL }}{{ result.object.mediafile}}"
            class="fancybox-button"
            text = "{{ result.object.title }}">
            <img style="height: 250px; width: 250px; border: 1px solid red;" src="{{ MEDIA_URL }}{{ result.object.mediafile}}" class="img-responsive">
            <div class="zoomix"><i class="fa fa-search"></i></div>
          </a>
          <h3> <a href="{% url 'media_view' result.object.pk %}">{{ result.object.title }} </a> </h3>
          <i class="fa fa-user" style="color:red;"></i> {{ result.object.created_by }} <br />
          <i class="fa fa-calendar" style="color:red;"></i> {{result.object.created_at}} <br />
        </div>

        {% endif %}
        {% endfor %}

        </div>


        <!-- <br>
            <h3> Media </h3>
            {% for result in object_list %}

                {% if result.object.mediafile %}
                 File = {{ result.object.mediafile }}
                 url = {{ result.object.get_absolute_url }} 
                 state = {{ result.object.state }}              

                {% endif %}
            {% endfor %}

        </div> -->



            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
   

{% endblock %}

