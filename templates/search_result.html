{% extends 'base.html' %}

{% block content %}
    <h2>Search</h2>

    <form method="get" action=".">
        <table>
            <!-- {{ form.as_table }} -->
            <tr>
                <td>&nbsp;</td>
                <td>
                    <input type="text" placeholder="Search" name="q" id="q" autocomplete="off">


                    <div class="input-group mb-3">
                      <div class="input-group-prepend">
                        <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Dropdown</button>
                        <div class="dropdown-menu">
                          <a class="dropdown-item" href="#">Action</a>
                          <a class="dropdown-item" href="#">Another action</a>
                          <a class="dropdown-item" href="#">Something else here</a>
                          <div role="separator" class="dropdown-divider"></div>
                          <a class="dropdown-item" href="#">Separated link</a>
                        </div>
                      </div>
                      <input type="text" class="form-control" aria-label="Text input with dropdown button">
                    </div>


                <div id="selction-ajax"></div>
                </td>
            </tr>
        </table>
     </form>
<!-- Object_list: {{ page.object_list }} -->
{% if  facets %}
facets: {{ facets.fields.category }}
<div class="col-md-3">
    <h3>Filters</h3>
        <dl>
        {% if facets.fields.category %}
        <dt>Filter by category</dt>
        {% for category in facets.fields.category %}
        {% if category.1 != 0 %}
        <dd>
        <input class="facet" id="{{category.0|cut:" "}}" type="checkbox" name="category" value="{{ category.0 }}" 
        data-toggle="toggle" /> {{ category.0 }} ({{ category.1 }})
        </dd>
        {% endif %}
        {% endfor %}
        {% endif %}
        </dl>
        <div>
        <input class="btn btn-info btn-sm pull-right" type="submit" value="apply filter" onclick="return onFacetChangeApplied();" />
        </div>
        

    </div>
{% endif %}





        {% if query %}
            <h3>Results</h3>
            <div class="col-md-12 col-sm-12">
            <div class="row content-page">
            <h3> Communities </h3>
               
            {% for result in object_list %}
                
                {% if result.object.name %}

                <!-- BEGIN CONTENT -->
                <!-- <div class="col-md-12 col-sm-12">
                  <div class="content-page"> -->
                    <div class="mix-grid thumbnails">
                      {{myhtml|safe}}{% autoescape off%}
                      <!-- <div class="infinite-item"> -->
                       <div class="col-md-3 col-sm-4 mix mix_all" style="display: block; opacity: 1; width: 280px;">
                        <div class="mix-inner">
                          {% if result.object.image %}
                          <img src="{{ MEDIA_URL }}{{ community.image}}" alt="image" class="img-responsive" style="height: 280px; width: 280px;">
                          {% else %}
                          <img src="{{ MEDIA_URL }}default/community_image_default.png" alt="default" class="img-responsive" style="height: 280px; width: 280px;">
                          {%endif%}

                          <div class="mix-details">
                            <h4>{{result.object.name}}</h4>
                            <h5>{{result.object.tag_line|truncatewords:5}}</h5>
                            <p>{{ result.object.desc |striptags|truncatewords:20}}</p>
                            <a class="mix-link" href="{% url 'community_view' result.object.pk %}">
                              <i class="fa fa-link"></i>View More
                            </a>

                            {% if result.object.image %}
                            <a data-rel="fancybox-button" title="{{result.object.name}}" href="{{ MEDIA_URL }}{{ result.object.image}}" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% else %}
                            <a data-rel="fancybox-button" title="{{result.object.name}}" href="{{ MEDIA_URL }}default/community_image_default.png" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% endif %}

                          </div>
                        <h3>{{result.object.name|truncatewords:2}}</h3>
                        {{result.object.category|truncatewords:2 }}
                      </div>
                    </div>
                      <!-- </div> -->
                      {% endautoescape%}
                    </div>
                <!--   </div>
                </div> -->
                {% endif %}

            
                <!-- END CONTENT -->

                <!-- <p>
                    <a href="{{ result.object.get_absolute_url }}">{{ result.object.name }} {{ result.object.title }} {{ result.object.created_at }}</a>
                </p> -->
            {% empty %}
                <p>No results found.</p>
            {% endfor %}

        </div>
        </div>

        <div class="container">
            <h3> Articles </h3>
            {% for result in object_list %}
                {% if result.object.title %}
                <!-- BEGIN CONTENT -->
                <div class="infinite-container">
                      {{myhtml|safe}}{% autoescape off%}
                      <div class="infinite-item">
                       <div class="col-md-3 col-sm-4 mix mix_all" style="display: block; opacity: 1; width: 280px;">
                        <div class="mix-inner">
                          {% if result.object.image %}
                          <img src="{{ MEDIA_URL }}{{ article.image}}" alt="image" class="img-responsive" style="height: 280px; width: 280px;">
                          {% else %}
                          <img src="{{ MEDIA_URL }}default/article_image_default.png" alt="default" class="img-responsive" style="height: 280px; width: 280px;">
                          {%endif%}

                          <div class="mix-details">
                            <h4>{{result.object.title}}</h4>
                            <h5>{{result.object.tag_line|truncatewords:5}}</h5>
                            <p>{{ result.object.desc |striptags|truncatewords:20}}</p>
                            <a class="mix-link" href="{% url 'article_view' result.object.pk %}">
                              <i class="fa fa-link"></i>View More
                            </a>

                            {% if result.object.image %}
                            <a data-rel="fancybox-button" title="{{result.object.title}}" href="{{ MEDIA_URL }}{{ result.object.image}}" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% else %}
                            <a data-rel="fancybox-button" title="{{result.object.title}}" href="{{ MEDIA_URL }}default/article_image_default.png" class="mix-preview fancybox-button">
                              <i class="fa fa-search"></i>View Image
                            </a>
                            {% endif %}

                          </div>
                        <h3>{{result.object.name|truncatewords:2}}</h3>
                        {{result.object.category|truncatewords:2 }}
                      </div>
                      </div>
                  </div>
                {% endautoescape%}
                </div>
                {% endif %}

            
                <!-- END CONTENT -->

                <!-- <p>
                    <a href="{{ result.object.get_absolute_url }}">{{ result.object.name }} {{ result.object.title }} {{ result.object.created_at }}</a>
                </p> -->
            {% empty %}
                <p>No results found.</p>
            {% endfor %}

        </div>



            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            {# Show some example queries to run, maybe query syntax, something else? #}
        {% endif %}
   
{% endblock %}

{% block javascript %}
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
{% endblock %}